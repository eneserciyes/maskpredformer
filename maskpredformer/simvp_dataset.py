# AUTOGENERATED! DO NOT EDIT! File to edit: ../nbs/01_simvp_dataset.ipynb.

# %% auto 0
__all__ = ['DEFAULT_DATA_PATH', 'DLDataset']

# %% ../nbs/01_simvp_dataset.ipynb 2
from torch.utils.data import Dataset
import torch
import os
from torchvision import transforms
from .vis_utils import show_video_line

# %% ../nbs/01_simvp_dataset.ipynb 3
DEFAULT_DATA_PATH = "/home/enes/dev/maskpredformer/data/DL"

# %% ../nbs/01_simvp_dataset.ipynb 4
class DLDataset(Dataset):
    def __init__(self, root, mode, unlabeled=False):
        self.mask_path = os.path.join(root, f"{mode}_masks.pt")
        self.mode = mode
        print("INFO: Loading masks from", self.mask_path)
        if unlabeled:
            self.masks = torch.cat([
                torch.load(self.mask_path), 
                torch.load(os.path.join(root, f"unlabeled_masks.pt"))
            ], dim=0)
        else:
            self.masks = torch.load(self.mask_path)
        self.transform = transforms.Compose([
            transforms.RandomHorizontalFlip(p=0.5),
        ])

    def __len__(self):
        return self.masks.shape[0]
    
    def __getitem__(self, idx):
        if self.mode == "train":
            ep = self.transform(self.masks[idx])
        else:
            ep = self.masks[idx]
        data = ep[:11].long()
        labels = ep[11:].long()
        return data, labels
